sudo: required
services:
- docker
language: node_js
node_js: node
script:
- cd ./tests/signaling-server/
- docker build -t signaling .
- docker run -d -p 5000:5000 --name signaling -e "PORT=5000" -e "HOST=localhost" signaling
- cd ../../
- npm run build:debug
- npm run build:prod
- npm run test
- npm run doc:build
- docker kill signaling
- docker rm signaling
- docker rmi signaling
deploy:
  provider: heroku
  api_key:
    secure: DMoJvf2PnKQioFHb90Pltfnd0LWmOxff6JTHaiPyKrcJQ2rgBxMtEPDkxP2IQn3zz0XTkexWqixViX8hCoDh8MkiM/arWC+1jlXAGQWHSeChTC6rYdj+5MY/3PjHPVLJw9R1oS082oqi8Szoi9yM96fxSWWTxSh9hZ3E4/bjihZmjW1VDupSAVW365u1dYVS016s5PjAc8zdnc7A6HUBGFZs//1dRw13gKH3agbzQCAR4Co6mv3vbXqG1j9x57oRlb5nrQ6J6QLt+nQk0zYOteT0QAe+BjOw1QAFT3w2amjbOskG/IXZJsIUh4/TXCgzoXiEUTwKwlhJjX6XteBqJ9MbRiD4Z70c7Cq1iZBOslq9sxUepjVCmJyS0IZZhTc0pn+zZEH7IGSfomWGn5Ap9sIkGcdXyXVTs3UZcgcXM0xNZE5/oYudDUlhsYRU8jonBmzLr2K2wyXzPQoX+uEEKz9A53YDNbfvz2mHpDxTuRV54Dm5eO02MZ5lPK+En5sAZEQrISTt3lIcwl67SdER73O5+bj0hYuGQvn1vgT+n7CmSfya0fcuxapkhgUSfWWbIHTEQ71YfS+VyA8k5zQwO/3tHLwOgxO7LBhFnAx/Ge1D+8WRmh9ff6lRM7LnF7zwEK2uvw8CaRe4e06pQWengCqmkWpKCzIzgkJlVtMJkmk=
  app: signaling-v2
  on:
    branch: foglet-rework
